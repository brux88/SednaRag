{
  "clientId": "erp_ortofrutticolo",
  "tables": [
    {
      "name": "TestataDocumento",
      "description": "Tabella principale per le testate dei documenti di acquisto e vendita",
      "columns": [
        {
          "name": "Id",
          "dataType": "uniqueidentifier",
          "description": "Identificativo univoco del documento",
          "isPrimaryKey": true,
          "isForeignKey": false
        },
        {
          "name": "Tipo",
          "dataType": "nvarchar",
          "description": "Indica se è un documento di acquisto (A) o di vendita (V)",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "Tipo4",
          "dataType": "nvarchar",
          "description": "Indica il tipo specifico di documento: VFI (fattura immediata vendita), VDT (documento di trasporto vendita), VFD (fattura differita vendita), VNC (nota credito vendita), AFI (fattura immediata acquisto), ADT (documento di trasporto acquisto), AFD (fattura differita acquisto), ANC (nota credito acquisto), AMBR (movimento bancario ricavo), AMBU (movimento bancario uscita), VMBR (movimento bancario ricavo vendita), VMBU (movimento bancario uscita vendita)",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "NumeroDocumento",
          "dataType": "long",
          "description": "Numero progressivo del documento",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "LetteraDocumento",
          "dataType": "nvarchar",
          "description": "Lettera identificativa del documento",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "DataDocumento",
          "dataType": "datetime",
          "description": "Data del documento in formato italiano (dd/MM/yyyy)",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "CodiceCliente",
          "dataType": "nvarchar",
          "description": "Codice del cliente associato al documento",
          "isPrimaryKey": false,
          "isForeignKey": true,
          "referencedTable": "Clienti",
          "referencedColumn": "Codice"
        },
        {
          "name": "RagioneSocialeCliente",
          "dataType": "nvarchar",
          "description": "Ragione sociale del cliente",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "CodiceFornitore",
          "dataType": "nvarchar",
          "description": "Codice del fornitore associato al documento",
          "isPrimaryKey": false,
          "isForeignKey": true,
          "referencedTable": "Fornitori",
          "referencedColumn": "Codice"
        },
        {
          "name": "RagioneSocialeFornitore",
          "dataType": "nvarchar",
          "description": "Ragione sociale del fornitore",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "TotaleImponibile",
          "dataType": "decimal",
          "description": "Totale imponibile del documento",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "TotaleIva",
          "dataType": "decimal",
          "description": "Importo totale dell'IVA",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "Iva",
          "dataType": "decimal",
          "description": "Percentuale di IVA applicata",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "TassoValuta",
          "dataType": "decimal",
          "description": "Tasso di cambio della valuta",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "CodiceValuta",
          "dataType": "nvarchar",
          "description": "Codice della valuta utilizzata",
          "isPrimaryKey": false,
          "isForeignKey": false
        }
      ],
      "relations": [
        {
          "type": "ManyToOne",
          "fromColumn": "CodiceCliente",
          "toTable": "Clienti",
          "toColumn": "Codice"
        },
        {
          "type": "ManyToOne",
          "fromColumn": "CodiceFornitore",
          "toTable": "Fornitori",
          "toColumn": "Codice"
        },
        {
          "type": "OneToMany",
          "fromColumn": "Id",
          "toTable": "CorpoDocumento",
          "toColumn": "IdTestata"
        }
      ],
      "indexes": [
        {
          "name": "IDX_TestataDocumento_Tipo",
          "columns": ["Tipo"],
          "isUnique": false
        },
        {
          "name": "IDX_TestataDocumento_Tipo4",
          "columns": ["Tipo4"],
          "isUnique": false
        },
        {
          "name": "IDX_TestataDocumento_DataDocumento",
          "columns": ["DataDocumento"],
          "isUnique": false
        },
        {
          "name": "IDX_TestataDocumento_CodiceCliente",
          "columns": ["CodiceCliente"],
          "isUnique": false
        },
        {
          "name": "IDX_TestataDocumento_CodiceFornitore",
          "columns": ["CodiceFornitore"],
          "isUnique": false
        }
      ],
      "commonUsage": "La tabella TestataDocumento (spesso abbreviata come TD) contiene le informazioni principali di ogni documento emesso o ricevuto. È usata per registrare fatture, DDT, note di credito sia di vendita che di acquisto. Per le vendite, Tipo='V' e per gli acquisti, Tipo='A'. Il campo Tipo4 specifica il tipo esatto di documento. Include anche movimenti bancari con i tipi AMBR, AMBU, VMBR, VMBU.",
      "module": "documenti",
      "keywords": ["documento", "fattura", "ddt", "vendita", "acquisto", "testata", "movimento bancario"]
    },
    {
      "name": "CorpoDocumento",
      "description": "Tabella per le righe di dettaglio dei documenti",
      "columns": [
        {
          "name": "IdTestata",
          "dataType": "uniqueidentifier",
          "description": "Riferimento alla testata del documento",
          "isPrimaryKey": false,
          "isForeignKey": true,
          "referencedTable": "TestataDocumento",
          "referencedColumn": "Id"
        },
        {
          "name": "TipoArticolo",
          "dataType": "nvarchar",
          "description": "Tipo di riga: AR (articoli/prodotti), IM (imballaggi), AC (accessori), NO (note), PE (pedane), SV (servizi), BA (bancali)",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "NumeroLotto",
          "dataType": "int",
          "description": "Numero di lotto per la tracciabilità",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "LottoProduttore",
          "dataType": "nvarchar",
          "description": "Lotto associato al produttore o fornitore",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "LottoLavorazione",
          "dataType": "nvarchar",
          "description": "Lotto della lavorazione interna",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "CodiceArticolo",
          "dataType": "nvarchar",
          "description": "Codice dell'articolo",
          "isPrimaryKey": false,
          "isForeignKey": true,
          "referencedTable": "Articoli",
          "referencedColumn": "Codice"
        },
        {
          "name": "DescrizioneArticolo",
          "dataType": "nvarchar",
          "description": "Descrizione dell'articolo",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "NumeroColli",
          "dataType": "decimal",
          "description": "Numero di cassette o imballaggi",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "PesoTara",
          "dataType": "decimal",
          "description": "Peso dell'imballaggio",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "PesoTaraUnitario",
          "dataType": "decimal",
          "description": "Peso unitario della tara",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "PesoNetto",
          "dataType": "decimal",
          "description": "Quantità effettiva del prodotto",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "PesoLordo",
          "dataType": "decimal",
          "description": "Peso lordo comprensivo di tara e prodotto",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "PesoNettoKG",
          "dataType": "decimal",
          "description": "Peso netto convertito in KG (per conversioni unità di misura)",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "Prezzo",
          "dataType": "decimal",
          "description": "Prezzo unitario",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "PrezzoLordo",
          "dataType": "decimal",
          "description": "Prezzo lordo prima degli sconti",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "PrezzoIvato",
          "dataType": "decimal",
          "description": "Prezzo comprensivo di IVA",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "PrezzoValuta",
          "dataType": "decimal",
          "description": "Prezzo in valuta estera",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "Imponibile",
          "dataType": "decimal",
          "description": "Valore totale della riga",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "ImponibileLordo",
          "dataType": "decimal",
          "description": "Valore totale lordo prima degli sconti",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "ImponibileValuta",
          "dataType": "decimal",
          "description": "Imponibile in valuta estera",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "AliquotaIva",
          "dataType": "decimal",
          "description": "Percentuale IVA applicata alla riga",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "ImportoIva",
          "dataType": "decimal",
          "description": "Importo IVA calcolato",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "ImponibileIvato",
          "dataType": "decimal",
          "description": "Imponibile comprensivo di IVA",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "Sconto",
          "dataType": "decimal",
          "description": "Importo dello sconto applicato",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "ScontoIvato",
          "dataType": "decimal",
          "description": "Importo dello sconto comprensivo di IVA",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "PercentualeSconto1Riga",
          "dataType": "decimal",
          "description": "Percentuale del primo sconto",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "PercentualeSconto2Riga",
          "dataType": "decimal",
          "description": "Percentuale del secondo sconto",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "PercentualeSconto3Riga",
          "dataType": "decimal",
          "description": "Percentuale del terzo sconto",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "PercentualeProvvigione",
          "dataType": "decimal",
          "description": "Percentuale della provvigione",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "ImportoProvvigione",
          "dataType": "decimal",
          "description": "Importo della provvigione calcolata",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "NumeroPezzi",
          "dataType": "decimal",
          "description": "Numero di pezzi/unità contenuti",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "NumeroPezziConfezione",
          "dataType": "decimal",
          "description": "Numero di pezzi per confezione",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "PrezzoPezzi",
          "dataType": "decimal",
          "description": "Prezzo per singolo pezzo",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "QuantitaBancale",
          "dataType": "decimal",
          "description": "Quantità per bancale",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "NumeroBancale",
          "dataType": "decimal",
          "description": "Numero di bancali",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "TipoCalcoloConfezione",
          "dataType": "nvarchar",
          "description": "Tipo di calcolo per confezione: CPE (calcolo per pezzo), CPZ (calcolo per pezzi), CCL (calcolo per colli), FO (calcolo per fori)",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "NumeroPedana",
          "dataType": "decimal",
          "description": "Numero di pedane",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "PesoPedana",
          "dataType": "decimal",
          "description": "Peso delle pedane",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "PesoPedanaUnitario",
          "dataType": "decimal",
          "description": "Peso unitario della pedana",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "PrezzoPedanaProduttore",
          "dataType": "decimal",
          "description": "Prezzo della pedana applicato dal produttore",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "PercentualeScarto",
          "dataType": "decimal",
          "description": "Percentuale di scarto da applicare",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "Scarto",
          "dataType": "decimal",
          "description": "Quantità di scarto calcolata",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "PrezzoNetto",
          "dataType": "decimal",
          "description": "Prezzo netto dopo sconti",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "PrezzoKG",
          "dataType": "decimal",
          "description": "Prezzo al KG",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "TipoImballaggio",
          "dataType": "nvarchar",
          "description": "Tipo di imballaggio: IP (imballaggio a parte), PF (prezzo fisso)",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "PrezzoImballaggio",
          "dataType": "decimal",
          "description": "Prezzo dell'imballaggio",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "ImponibileImballaggio",
          "dataType": "decimal",
          "description": "Imponibile calcolato per l'imballaggio",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "IncidenzaImballaggiPrezzo",
          "dataType": "decimal",
          "description": "Incidenza dell'imballaggio sul prezzo",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "PrezzoImballoProduttore",
          "dataType": "decimal",
          "description": "Prezzo dell'imballaggio applicato dal produttore",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "CaloPeso",
          "dataType": "decimal",
          "description": "Calo peso tra documento e fattura differita",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "PesoNettoDifferita",
          "dataType": "decimal",
          "description": "Peso netto per la fattura differita",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "PesoNettoCalo",
          "dataType": "decimal",
          "description": "Peso netto dopo il calo peso",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "MediaPeso",
          "dataType": "decimal",
          "description": "Media del peso per collo",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "NumeroDocumento",
          "dataType": "long",
          "description": "Numero del documento (duplicato dalla testata)",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "LetteraDocumento",
          "dataType": "nvarchar",
          "description": "Lettera del documento (duplicato dalla testata)",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "DataDocumento",
          "dataType": "datetime",
          "description": "Data del documento (duplicato dalla testata)",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "RagioneSocialeCliente",
          "dataType": "nvarchar",
          "description": "Ragione sociale del cliente (duplicato dalla testata)",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "AnnoLotto",
          "dataType": "int",
          "description": "Anno di riferimento del lotto",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "NumeroFori",
          "dataType": "decimal",
          "description": "Numero di fori per calcolo FO",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "Totale",
          "dataType": "decimal",
          "description": "Totale comprensivo di IVA",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "DifferenzaTotale",
          "dataType": "decimal",
          "description": "Differenza tra Totale e ImponibileIvato",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "DataOraUltimaModifica",
          "dataType": "datetime",
          "description": "Data e ora dell'ultima modifica alla riga",
          "isPrimaryKey": false,
          "isForeignKey": false
        }
      ],
      "relations": [
        {
          "type": "ManyToOne",
          "fromColumn": "IdTestata",
          "toTable": "TestataDocumento",
          "toColumn": "Id"
        },
        {
          "type": "ManyToOne",
          "fromColumn": "CodiceArticolo",
          "toTable": "Articoli",
          "toColumn": "Codice"
        }
      ],
      "indexes": [
        {
          "name": "IDX_CorpoDocumento_IdTestata",
          "columns": ["IdTestata"],
          "isUnique": false
        },
        {
          "name": "IDX_CorpoDocumento_TipoArticolo",
          "columns": ["TipoArticolo"],
          "isUnique": false
        },
        {
          "name": "IDX_CorpoDocumento_CodiceArticolo",
          "columns": ["CodiceArticolo"],
          "isUnique": false
        },
        {
          "name": "IDX_CorpoDocumento_NumeroLotto",
          "columns": ["NumeroLotto"],
          "isUnique": false
        },
        {
          "name": "IDX_CorpoDocumento_DataDocumento",
          "columns": ["DataDocumento"],
          "isUnique": false
        }
      ],
      "commonUsage": "La tabella CorpoDocumento (spesso abbreviata come CD) contiene tutte le righe di dettaglio dei documenti. È utilizzata per registrare i singoli articoli, quantità, prezzi e importi. Quando si calcolano le quantità vendute o acquistate, si utilizza PesoNetto. Per i calcoli di prezzo medio ponderato, si usa sempre SUM(Imponibile)/SUM(PesoNetto). I campi NumeroDocumento, LetteraDocumento, DataDocumento e RagioneSocialeCliente sono duplicati dalla testata per evitare join.",
      "module": "documenti",
      "keywords": ["righe", "articoli", "lotti", "prezzi", "quantità", "corpo documento", "calcoli", "pesi", "colli", "sconti"]
    },
    {
      "name": "TestataContabilita",
      "description": "Tabella per le testate dei movimenti contabili",
      "columns": [
        {
          "name": "Id",
          "dataType": "uniqueidentifier",
          "description": "Identificativo univoco della registrazione contabile",
          "isPrimaryKey": true,
          "isForeignKey": false
        },
        {
          "name": "Tipo",
          "dataType": "nvarchar",
          "description": "Tipo di movimento: M (movimento), V (vendita), A (acquisto), I (incasso), P (pagamento)",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "Tipo4",
          "dataType": "nvarchar",
          "description": "Tipo specifico di documento collegato: VFI, VDT, VFD, VNC, AFI, ADT, AFD, ANC",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "NumeroRegistrazione",
          "dataType": "long",
          "description": "Numero progressivo della registrazione contabile",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "DataRegistrazione",
          "dataType": "datetime",
          "description": "Data della registrazione in formato italiano (dd/MM/yyyy)",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "CodiceCausaleContabile",
          "dataType": "nvarchar",
          "description": "Codice della causale contabile",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "DescrizioneCausaleContabile",
          "dataType": "nvarchar",
          "description": "Descrizione della causale contabile",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "CodiceCliente",
          "dataType": "nvarchar",
          "description": "Codice del cliente collegato alla registrazione",
          "isPrimaryKey": false,
          "isForeignKey": true,
          "referencedTable": "Clienti",
          "referencedColumn": "Codice"
        },
        {
          "name": "RagioneSocialeCliente",
          "dataType": "nvarchar",
          "description": "Ragione sociale del cliente",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "CodiceFornitore",
          "dataType": "nvarchar",
          "description": "Codice del fornitore collegato alla registrazione",
          "isPrimaryKey": false,
          "isForeignKey": true,
          "referencedTable": "Fornitori",
          "referencedColumn": "Codice"
        },
        {
          "name": "RagioneSocialeFornitore",
          "dataType": "nvarchar",
          "description": "Ragione sociale del fornitore",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "TotaleAvere",
          "dataType": "decimal",
          "description": "Totale delle registrazioni in avere",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "TotaleDare",
          "dataType": "decimal",
          "description": "Totale delle registrazioni in dare",
          "isPrimaryKey": false,
          "isForeignKey": false
        }
      ],
      "relations": [
        {
          "type": "ManyToOne",
          "fromColumn": "CodiceCliente",
          "toTable": "Clienti",
          "toColumn": "Codice"
        },
        {
          "type": "ManyToOne",
          "fromColumn": "CodiceFornitore",
          "toTable": "Fornitori",
          "toColumn": "Codice"
        },
        {
          "type": "OneToMany",
          "fromColumn": "Id",
          "toTable": "CorpoContabilita",
          "toColumn": "IdTestata"
        }
      ],
      "indexes": [
        {
          "name": "IDX_TestataContabilita_Tipo",
          "columns": ["Tipo"],
          "isUnique": false
        },
        {
          "name": "IDX_TestataContabilita_DataRegistrazione",
          "columns": ["DataRegistrazione"],
          "isUnique": false
        },
        {
          "name": "IDX_TestataContabilita_CodiceCliente",
          "columns": ["CodiceCliente"],
          "isUnique": false
        },
        {
          "name": "IDX_TestataContabilita_CodiceFornitore",
          "columns": ["CodiceFornitore"],
          "isUnique": false
        }
      ],
      "commonUsage": "La tabella TestataContabilita (spesso abbreviata come TC) contiene le registrazioni contabili principali. Ogni movimento contabile ha sempre una testata con i dettagli generali e righe collegate che rappresentano i conti movimentati. La tabella è utilizzata per bilanci, rendiconti e analisi finanziarie.",
      "module": "contabilita",
      "keywords": ["contabilità", "registrazione", "partita doppia", "movimento", "incasso", "pagamento"]
    },
    {
      "name": "CorpoContabilita",
      "description": "Tabella per le righe di dettaglio dei movimenti contabili",
      "columns": [
        {
          "name": "IdTestata",
          "dataType": "uniqueidentifier",
          "description": "Riferimento alla testata della registrazione contabile",
          "isPrimaryKey": false,
          "isForeignKey": true,
          "referencedTable": "TestataContabilita",
          "referencedColumn": "Id"
        },
        {
          "name": "Sezionale",
          "dataType": "nvarchar",
          "description": "Indica il tipo di registrazione: D (dare - uscita di valore o incremento attività), A (avere - entrata di valore o incremento passività)",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "CodiceContoContabile",
          "dataType": "nvarchar",
          "description": "Codice del conto contabile movimentato",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "DescrizioneContoContabile",
          "dataType": "nvarchar",
          "description": "Descrizione del conto contabile",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "ImportoDare",
          "dataType": "decimal",
          "description": "Importo registrato nella colonna Dare",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "ImportoAvere",
          "dataType": "decimal",
          "description": "Importo registrato nella colonna Avere (corretto da ImpoortoAvere)",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "AliquotaIva",
          "dataType": "decimal",
          "description": "Aliquota IVA applicata",
          "isPrimaryKey": false,
          "isForeignKey": false
        }
      ],
      "relations": [
        {
          "type": "ManyToOne",
          "fromColumn": "IdTestata",
          "toTable": "TestataContabilita",
          "toColumn": "Id"
        }
      ],
      "indexes": [
        {
          "name": "IDX_CorpoContabilita_IdTestata",
          "columns": ["IdTestata"],
          "isUnique": false
        },
        {
          "name": "IDX_CorpoContabilita_CodiceContoContabile",
          "columns": ["CodiceContoContabile"],
          "isUnique": false
        },
        {
          "name": "IDX_CorpoContabilita_Sezionale",
          "columns": ["Sezionale"],
          "isUnique": false
        }
      ],
      "commonUsage": "La tabella CorpoContabilita (spesso abbreviata come CC) contiene i dettagli delle registrazioni contabili. Ogni riga rappresenta un movimento su un conto specifico. La partita doppia è garantita dal fatto che la somma degli importi in Dare deve essere uguale alla somma degli importi in Avere per ogni registrazione.",
      "module": "contabilita",
      "keywords": ["conti", "dare", "avere", "partita doppia", "movimento contabile"]
    },
    {
      "name": "CorpoRicezioneMerceTemp",
      "description": "Tabella temporanea per la ricezione della merce",
      "columns": [
        {
          "name": "TipoArticolo",
          "dataType": "nvarchar",
          "description": "Tipo di riga: AR (articoli/prodotti), IM (imballaggi), AC (accessori), NO (note), PE (pedane), SV (servizi)",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "NumeroLotto",
          "dataType": "int",
          "description": "Numero di lotto per la tracciabilità",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "LottoProduttore",
          "dataType": "nvarchar",
          "description": "Lotto associato al produttore o fornitore",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "CodiceArticolo",
          "dataType": "nvarchar",
          "description": "Codice dell'articolo",
          "isPrimaryKey": false,
          "isForeignKey": true,
          "referencedTable": "Articoli",
          "referencedColumn": "Codice"
        },
        {
          "name": "DescrizioneArticolo",
          "dataType": "nvarchar",
          "description": "Descrizione dell'articolo",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "NumeroColli",
          "dataType": "decimal",
          "description": "Numero di cassette o imballaggi",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "PesoTara",
          "dataType": "decimal",
          "description": "Peso dell'imballaggio",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "PesoNetto",
          "dataType": "decimal",
          "description": "Quantità effettiva del prodotto",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "Prezzo",
          "dataType": "decimal",
          "description": "Prezzo unitario",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "Imponibile",
          "dataType": "decimal",
          "description": "Valore totale della riga",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "AliquotaIva",
          "dataType": "decimal",
          "description": "Percentuale IVA applicata alla riga",
          "isPrimaryKey": false,
          "isForeignKey": false
        }
      ],
      "relations": [
        {
          "type": "ManyToOne",
          "fromColumn": "CodiceArticolo",
          "toTable": "Articoli",
          "toColumn": "Codice"
        }
      ],
      "indexes": [
        {
          "name": "IDX_CorpoRicezioneMerceTemp_CodiceArticolo",
          "columns": ["CodiceArticolo"],
          "isUnique": false
        },
        {
          "name": "IDX_CorpoRicezioneMerceTemp_NumeroLotto",
          "columns": ["NumeroLotto"],
          "isUnique": false
        }
      ],
      "commonUsage": "La tabella CorpoRicezioneMerceTemp è utilizzata temporaneamente durante il processo di ricezione merce. Contiene le righe di dettaglio della merce in arrivo prima che vengano trasferite in documenti ufficiali come DDT o fatture di acquisto.",
      "module": "magazzino",
      "keywords": ["ricezione", "merce", "temporaneo", "lotti", "acquisto"]
    },
    {
      "name": "Clienti",
      "description": "Anagrafica clienti",
      "columns": [
        {
          "name": "Codice",
          "dataType": "nvarchar",
          "description": "Codice identificativo del cliente",
          "isPrimaryKey": true,
          "isForeignKey": false
        },
        {
          "name": "RagioneSociale",
          "dataType": "nvarchar",
          "description": "Ragione sociale del cliente",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "Indirizzo",
          "dataType": "nvarchar",
          "description": "Indirizzo del cliente",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "Comune",
          "dataType": "nvarchar",
          "description": "Comune del cliente",
          "isPrimaryKey": false,
          "isForeignKey": false
        }
      ],
      "relations": [],
      "indexes": [
        {
          "name": "IDX_Clienti_RagioneSociale",
          "columns": ["RagioneSociale"],
          "isUnique": false
        },
        {
          "name": "IDX_Clienti_Comune",
          "columns": ["Comune"],
          "isUnique": false
        }
      ],
      "commonUsage": "La tabella Clienti (spesso abbreviata come CL) contiene tutti i dati anagrafici dei clienti. È utilizzata per la gestione delle vendite, fatturazione, spedizioni e analisi commerciali.",
      "module": "anagrafiche",
      "keywords": ["clienti", "anagrafica", "vendite", "fatturazione"]
    },
    {
      "name": "Fornitori",
      "description": "Anagrafica fornitori",
      "columns": [
        {
          "name": "Codice",
          "dataType": "nvarchar",
          "description": "Codice identificativo del fornitore",
          "isPrimaryKey": true,
          "isForeignKey": false
        },
        {
          "name": "RagioneSociale",
          "dataType": "nvarchar",
          "description": "Ragione sociale del fornitore",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "Indirizzo",
          "dataType": "nvarchar",
          "description": "Indirizzo del fornitore",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "Comune",
          "dataType": "nvarchar",
          "description": "Comune del fornitore",
          "isPrimaryKey": false,
          "isForeignKey": false
        }
      ],
      "relations": [],
      "indexes": [
        {
          "name": "IDX_Fornitori_RagioneSociale",
          "columns": ["RagioneSociale"],
          "isUnique": false
        },
        {
          "name": "IDX_Fornitori_Comune",
          "columns": ["Comune"],
          "isUnique": false
        }
      ],
      "commonUsage": "La tabella Fornitori (spesso abbreviata come FO) contiene tutti i dati anagrafici dei fornitori. È utilizzata per la gestione degli acquisti, ordini, pagamenti e analisi dei costi.",
      "module": "anagrafiche",
      "keywords": ["fornitori", "anagrafica", "acquisti", "pagamenti"]
    },
    {
      "name": "Articoli",
      "description": "Anagrafica articoli e prodotti",
      "columns": [
        {
          "name": "Codice",
          "dataType": "nvarchar",
          "description": "Codice identificativo dell'articolo",
          "isPrimaryKey": true,
          "isForeignKey": false
        },
        {
          "name": "Descrizione",
          "dataType": "nvarchar",
          "description": "Descrizione dell'articolo",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "CodiceSottoFamiglia",
          "dataType": "nvarchar",
          "description": "Codice della sottofamiglia/categoria/gruppo",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "DescrizioneSottofamiglia",
          "dataType": "nvarchar",
          "description": "Descrizione della sottofamiglia/categoria/gruppo",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "PesoMax",
          "dataType": "decimal",
          "description": "Peso massimo dell'articolo per controlli soglia",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "PesoMinimo",
          "dataType": "decimal",
          "description": "Peso minimo dell'articolo per controlli soglia",
          "isPrimaryKey": false,
          "isForeignKey": false
        }
      ],
      "relations": [],
      "indexes": [
        {
          "name": "IDX_Articoli_Descrizione",
          "columns": ["Descrizione"],
          "isUnique": false
        },
        {
          "name": "IDX_Articoli_CodiceSottoFamiglia",
          "columns": ["CodiceSottoFamiglia"],
          "isUnique": false
        }
      ],
      "commonUsage": "La tabella Articoli (spesso abbreviata come AR) contiene tutte le informazioni sui prodotti ortofrutticoli, imballaggi e altri articoli gestiti. È fondamentale per vendite, acquisti, magazzino e analisi di prodotto.",
      "module": "anagrafiche",
      "keywords": ["articoli", "prodotti", "frutta", "verdura", "anagrafica", "catalogo"]
    }
  ],
  "businessRules": [
    {
      "name": "Identificazione Tipo Documento",
      "description": "Regole per identificare i tipi di documento nel sistema",
      "details": "I documenti nel sistema sono identificati da codici. Il campo 'Tipo' indica la macro categoria (V = vendita, A = acquisto). Il campo 'Tipo4' specifica il tipo esatto: VFI (fattura immediata vendita), VDT (documento di trasporto vendita), VFD (fattura differita vendita), VNC (nota credito vendita), AFI (fattura immediata acquisto), ADT (documento di trasporto acquisto), AFD (fattura differita acquisto), ANC (nota credito acquisto), AMBR (movimento bancario ricavo), AMBU (movimento bancario uscita), VMBR (movimento bancario ricavo vendita), VMBU (movimento bancario uscita vendita). Questi codici sono fondamentali per filtrare correttamente i documenti nelle query.",
      "relatedTables": ["TestataDocumento", "CorpoDocumento", "TestataContabilita"],
      "examples": "Per trovare tutte le fatture di vendita: TestataDocumento.Tipo = 'V' AND TestataDocumento.Tipo4 IN ('VFI', 'VFD'). Per trovare tutti i documenti di trasporto: TestataDocumento.Tipo4 IN ('VDT', 'ADT').",
      "module": "documenti",
      "keywords": ["documento", "tipo", "vendita", "acquisto", "fattura", "ddt", "movimento bancario"]
    },
    {
      "name": "Calcolo Prezzo Medio Ponderato",
      "description": "Regola per il calcolo corretto del prezzo medio ponderato",
      "details": "Il prezzo medio ponderato deve sempre essere calcolato come SUM(Imponibile)/SUM(PesoNetto) e non come AVG(Prezzo). Questo perché il prezzo unitario (Prezzo) non tiene conto dei volumi, mentre l'imponibile (Imponibile) rappresenta il valore effettivo della transazione. Inoltre, per evitare errori di divisione per zero, utilizzare sempre NULLIF(SUM(PesoNetto), 0) nel denominatore.",
      "relatedTables": ["CorpoDocumento"],
      "examples": "Calcolo corretto: SELECT CodiceArticolo, SUM(Imponibile)/NULLIF(SUM(PesoNetto), 0) AS PrezzoMedioPonderato FROM CorpoDocumento GROUP BY CodiceArticolo",
      "module": "analisi",
      "keywords": ["prezzo", "media", "ponderata", "calcolo", "divisione"]
    },
    {
      "name": "Ricerca Articoli",
      "description": "Best practice per la ricerca degli articoli",
      "details": "Quando si cercano articoli per nome o descrizione, utilizzare sempre l'operatore LIKE con wildcard (%) invece di corrispondenze esatte. Questo garantisce che vengano trovate corrispondenze parziali indipendentemente dalla forma singolare/plurale o da piccole variazioni nel nome.",
      "relatedTables": ["Articoli", "CorpoDocumento"],
      "examples": "Invece di WHERE Articoli.Descrizione = 'pomodori', usare WHERE Articoli.Descrizione LIKE '%pomod%'",
      "module": "anagrafiche",
      "keywords": ["ricerca", "articoli", "like", "wildcard", "corrispondenza"]
    },
    {
      "name": "Partita Doppia Contabile",
      "description": "Regole della partita doppia in contabilità",
      "details": "Ogni registrazione contabile deve rispettare il principio della partita doppia: la somma dei valori in Dare deve essere uguale alla somma dei valori in Avere. Nel campo 'Sezionale' della tabella CorpoContabilita, 'D' indica Dare (uscita di valore o incremento di attività) e 'A' indica Avere (entrata di valore o incremento di passività).",
      "relatedTables": ["TestataContabilita", "CorpoContabilita"],
      "examples": "Verifica di una corretta registrazione: SELECT IdTestata, SUM(ImportoDare) as TotaleDare, SUM(ImportoAvere) as TotaleAvere FROM CorpoContabilita GROUP BY IdTestata HAVING SUM(ImportoDare) <> SUM(ImportoAvere)",
      "module": "contabilita",
      "keywords": ["partita doppia", "dare", "avere", "contabilità", "bilancio"]
    },
    {
      "name": "Calcolo Imponibile",
      "description": "Regole per il calcolo dell'imponibile e degli importi in documenti",
      "details": "Il calcolo dell'imponibile varia in base al tipo di articolo. Per articoli standard (AR), l'imponibile si calcola come Prezzo * PesoNetto - Sconto. Per imballaggi (IM), pedane (PE) e bancali (BA), si calcola come Prezzo * NumeroColli - Sconto. L'ImportoIva si calcola come (Imponibile * AliquotaIva) / 100. L'ImponibileIvato è la somma di Imponibile e ImportoIva.",
      "relatedTables": ["CorpoDocumento"],
      "examples": "Per un articolo standard: Imponibile = Prezzo * PesoNetto - Sconto. Per un imballaggio: Imponibile = Prezzo * NumeroColli - Sconto. ImportoIva = (Imponibile * AliquotaIva) / 100.",
      "module": "documenti",
      "keywords": ["imponibile", "calcolo", "iva", "sconti", "prezzo"]
    },
    {
      "name": "Calcolo Sconti a Cascata",
      "description": "Regole per l'applicazione degli sconti in cascata",
      "details": "Gli sconti vengono applicati in cascata utilizzando tre percentuali (PercentualeSconto1Riga, PercentualeSconto2Riga, PercentualeSconto3Riga). Il primo sconto si applica all'imponibile lordo, il secondo all'importo risultante dopo il primo sconto, e il terzo all'importo dopo il secondo sconto. Lo stesso meccanismo si applica per il calcolo degli sconti IVA.",
      "relatedTables": ["CorpoDocumento"],
      "examples": "Sconto1 = (ImponibileLordo * PercentualeSconto1Riga) / 100\nImponibile1 = ImponibileLordo - Sconto1\nSconto2 = (Imponibile1 * PercentualeSconto2Riga) / 100\nImponibile2 = Imponibile1 - Sconto2\nSconto3 = (Imponibile2 * PercentualeSconto3Riga) / 100\nScontoTotale = Sconto1 + Sconto2 + Sconto3",
      "module": "documenti",
      "keywords": ["sconti", "cascata", "percentuale", "imponibile", "calcolo"]
    },
    {
      "name": "Calcolo Tara e Peso Netto",
      "description": "Regole per il calcolo di tara e peso netto",
      "details": "Il peso della tara si calcola moltiplicando il peso unitario della tara per il numero di colli, con diversi tipi di arrotondamento (N: normale, E: per eccesso, D: per difetto, V: con decimali). Il peso netto si calcola sottraendo dal peso lordo il peso della tara, lo scarto e il peso delle pedane: PesoNetto = PesoLordo - PesoTara - PesoTaraPezzi - PesoPedana - Scarto.",
      "relatedTables": ["CorpoDocumento"],
      "examples": "Per il calcolo della tara con arrotondamento normale: PesoTara = ROUND(PesoTaraUnitario * NumeroColli)\nPer il calcolo del peso netto: PesoNetto = PesoLordo - PesoTara - PesoTaraPezzi - PesoPedana - Scarto",
      "module": "documenti",
      "keywords": ["tara", "peso netto", "peso lordo", "pedane", "arrotondamento", "scarto"]
    },
    {
      "name": "Arrotondamento Scarto",
      "description": "Regole per l'arrotondamento dello scarto",
      "details": "Lo scarto può essere arrotondato in tre modi: E (per eccesso), D (per difetto) o normale. Se il tipo di calcolo scarto è 'E', si usa CEILING, se è 'D' si usa FLOOR, altrimenti si usa ROUND con il numero di decimali specificato.",
      "relatedTables": ["CorpoDocumento"],
      "examples": "Se TipoCalcoloScarto = 'E': Scarto = CEILING(Scarto)\nSe TipoCalcoloScarto = 'D': Scarto = FLOOR(Scarto)\nAltrimenti: Scarto = ROUND(Scarto, NumeroDecimaliQuantita)",
      "module": "documenti",
      "keywords": ["scarto", "arrotondamento", "eccesso", "difetto", "decimali"]
    },
    {
      "name": "Calcolo Giacenza Movimenti Bancari",
      "description": "Regole per il calcolo della giacenza in movimenti bancari",
      "details": "Il calcolo della giacenza dipende dal tipo di movimento bancario. Per movimenti di tipo AMBR o VMBR (ricavi), la giacenza aumenta. Per movimenti di tipo AMBU o VMBU (uscite), la giacenza diminuisce. La formula è: Giacenza = GiacenzaOriginale + NumeroColli (per ricavi) o Giacenza = GiacenzaOriginale - NumeroColli (per uscite).",
      "relatedTables": ["TestataDocumento", "CorpoDocumento"],
      "examples": "Se Testata.Tipo4 = 'AMBR' o 'VMBR': Giacenza = GiacenzaOriginale + NumeroColli\nSe Testata.Tipo4 = 'AMBU' o 'VMBU': Giacenza = GiacenzaOriginale - NumeroColli",
      "module": "movimenti",
      "keywords": ["giacenza", "movimento bancario", "ricavo", "uscita", "colli"]
    },
    {
      "name": "Tipi di Calcolo Confezione",
      "description": "Regole per i diversi tipi di calcolo confezione",
      "details": "Il sistema supporta diversi tipi di calcolo per le confezioni: CPE (calcolo per pezzo), CPZ (calcolo per pezzi), CCL (calcolo per colli), FO (calcolo per fori). Ogni tipo utilizza formule diverse per calcolare NumeroColli, PesoNetto e altri valori correlati.",
      "relatedTables": ["CorpoDocumento"],
      "examples": "Se TipoCalcoloConfezione = 'CPZ': NumeroColli = INT(PesoNetto / NumeroPezziConfezione)\nSe TipoCalcoloConfezione = 'CCL': NumeroColli = INT(NumeroPezzi)\nSe TipoCalcoloConfezione = 'FO': NumeroColli = INT(PesoNetto / NumeroFori) e PesoNetto = NumeroColli * NumeroFori",
      "module": "produzione",
      "keywords": ["confezione", "pezzi", "colli", "fori", "calcolo"]
    },
    {
      "name": "Calcolo Prezzi e Imponibili in Valuta",
      "description": "Regole per il calcolo di prezzi e imponibili in valuta estera",
      "details": "Quando è attiva la gestione in valuta estera (VisualizzaFiltroValuta = true, TassoValuta != 0 e CodiceValuta non vuoto), il sistema calcola PrezzoValuta e ImponibileValuta. PrezzoValuta = Prezzo * TassoValuta e ImponibileValuta dipende dal tipo di articolo: per IM/PE/BA è PrezzoValuta * NumeroColli - Sconto, per altri è PrezzoValuta * PesoNetto - Sconto.",
      "relatedTables": ["TestataDocumento", "CorpoDocumento"],
      "examples": "PrezzoValuta = ROUND(Prezzo * TassoValuta, NumeroDecimaliImponibileMax)\nPer articoli standard: ImponibileValuta = ROUND(PrezzoValuta * PesoNetto - Sconto, NumeroDecimaliImponibile)\nPer imballaggi: ImponibileValuta = ROUND(PrezzoValuta * NumeroColli - Sconto, NumeroDecimaliImponibile)",
      "module": "contabilita",
      "keywords": ["valuta", "cambio", "prezzo", "imponibile", "tasso"]
    },
    {
      "name": "Controllo Pesi Minimi e Massimi",
      "description": "Regole per il controllo dei pesi minimi e massimi degli articoli",
      "details": "Il sistema può controllare se il peso netto è all'interno dei limiti previsti per l'articolo. Se PesoNetto > (PesoMax * NumeroColli) e PesoMax != 0, si avvisa l'utente che il peso è superiore alla media massima. Se PesoNetto < (PesoMinimo * NumeroColli) e PesoMinimo != 0, si avvisa che il peso è inferiore alla media minima.",
      "relatedTables": ["Articoli", "CorpoDocumento"],
      "examples": "PesoMassimoTotale = PesoMax * NumeroColli\nPesoMinimoTotale = PesoMinimo * NumeroColli\nSe PesoNetto > PesoMassimoTotale: 'Peso superiore alla media massima'\nSe PesoNetto < PesoMinimoTotale: 'Peso inferiore alla media minima'",
      "module": "qualita",
      "keywords": ["peso", "minimo", "massimo", "controllo", "articolo", "media"]
    }
  ],
  "storedProcedures": [
    {
      "name": "sp_GetVenditePerPeriodo",
      "description": "Recupera le vendite per un periodo specificato",
      "parameters": [
        {
          "name": "DataInizio",
          "dataType": "datetime",
          "description": "Data di inizio del periodo (formato dd/MM/yyyy)",
          "isOutput": false
        },
        {
          "name": "DataFine",
          "dataType": "datetime",
          "description": "Data di fine del periodo (formato dd/MM/yyyy)",
          "isOutput": false
        },
        {
          "name": "CodiceCliente",
          "dataType": "nvarchar",
          "description": "Codice cliente (opzionale, NULL per tutti)",
          "isOutput": false
        }
      ],
      "resultDescription": "Restituisce l'elenco delle vendite nel periodo con dettagli su articoli, quantità e importi",
      "usage": "EXEC sp_GetVenditePerPeriodo @DataInizio = '01/01/2023', @DataFine = '31/01/2023', @CodiceCliente = NULL",
      "module": "vendite",
      "keywords": ["vendite", "periodo", "cliente", "analisi"]
    },